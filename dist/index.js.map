{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import { h, Component } from 'preact';\n\nclass AsyncRoute extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tcomponentData: null\n\t\t};\n\t}\n\tloadComponent(){\n\t\tif (this.props.component) {\n\t\t\treturn this.setState({\n\t\t\t\tcomponentData: this.props.component\n\t\t\t});\n\t\t}\n\t\tconst componentData = this.props.getComponent(this.props.url, ({component}) => {\n      // Named param for making callback future proof\n\t\t\tif (component) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tcomponentData: component\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t// In case returned value was a promise\n\t\tif (componentData && componentData.then) {\n\t\t\t// IIFE to check if a later ending promise was creating a race condition\n\t\t\t// Check test case for more info\n\t\t\t((url)=>{\n\t\t\t\tcomponentData.then(component => {\n\t\t\t\t\tif (url === this.props.url) {\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tcomponentData: component\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})(this.props.url);\n\t\t}\n\t}\n\tcomponentDidMount(){\n\t\tthis.loadComponent();\n\t}\n\tcomponentWillReceiveProps(nextProps){\n\t\tif (this.props.url && this.props.url !== nextProps.url) {\n\t\t\tthis.setState({\n\t\t\t\tcomponentData: null\n\t\t\t}, ()=>{\n\t\t\t\tthis.loadComponent();\n\t\t\t});\n\t\t}\n\t}\n\trender(){\n\n\t\tif (this.state.componentData) {\n\t\t\treturn h(this.state.componentData, this.props);\n\t\t} else if (this.props.loading) {\n\t\t\tconst loadingComponent = this.props.loading();\n\t\t\treturn loadingComponent;\n\t\t}\n\t\treturn null;\n\t}\n}\n\nexport default AsyncRoute;"],"names":["AsyncRoute","state","loadComponent","props","component","setState","componentData","getComponent","url","then","componentDidMount","componentWillReceiveProps","nextProps","render","h","loading","loadingComponent","Component"],"mappings":";;;;;;;;;;;;AAAA,IAEMA;;;uBACS;;;+CACb,qBADa;;QAERC,KAAL,GAAa;kBACG;GADhB;;;;sBAIDC,yCAAe;;;MACV,KAAKC,KAAL,CAAWC,SAAf,EAA0B;UAClB,KAAKC,QAAL,CAAc;mBACL,KAAKF,KAAL,CAAWC;IADpB,CAAP;;MAIKE,gBAAgB,KAAKH,KAAL,CAAWI,YAAX,CAAwB,KAAKJ,KAAL,CAAWK,GAAnC,EAAwC,gBAAiB;OAAfJ,SAAe,QAAfA,SAAe;;;OAE1EA,SAAJ,EAAe;WACTC,QAAL,CAAc;oBACED;KADhB;;GAHoB,CAAtB;;;MAUIE,iBAAiBA,cAAcG,IAAnC,EAAyC;;;IAGvC,UAACD,GAAD,EAAO;kBACOC,IAAd,CAAmB,qBAAa;SAC3BD,QAAQ,OAAKL,KAAL,CAAWK,GAAvB,EAA4B;aACtBH,QAAL,CAAc;sBACED;OADhB;;KAFF;IADD,EAQG,KAAKD,KAAL,CAAWK,GARd;;;;sBAWFE,iDAAmB;OACbR,aAAL;;;sBAEDS,+DAA0BC,WAAU;;;MAC/B,KAAKT,KAAL,CAAWK,GAAX,IAAkB,KAAKL,KAAL,CAAWK,GAAX,KAAmBI,UAAUJ,GAAnD,EAAwD;QAClDH,QAAL,CAAc;mBACE;IADhB,EAEG,YAAI;WACDH,aAAL;IAHD;;;;sBAOFW,2BAAQ;;MAEH,KAAKZ,KAAL,CAAWK,aAAf,EAA8B;UACtBQ,SAAE,KAAKb,KAAL,CAAWK,aAAb,EAA4B,KAAKH,KAAjC,CAAP;GADD,MAEO,IAAI,KAAKA,KAAL,CAAWY,OAAf,EAAwB;OACxBC,mBAAmB,KAAKb,KAAL,CAAWY,OAAX,EAAzB;UACOC,gBAAP;;SAEM,IAAP;;;;EAzDuBC,kBA6DzB;;;;"}